<!DOCTYPE html>
<html lang="en-US">
<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<title>Enabling multiplexing to improve network concurrency performance - Trojan-Go Docs</title>
<meta name="description" content="An unidentifiable mechanism that helps you bypass GFW.">
<meta name="generator" content="Hugo 0.108.0">
<link href="https://azadzadeh.github.io/trojan-goindex.xml" rel="alternate" type="application/rss+xml">
<link rel="canonical" href="https://azadzadeh.github.io/trojan-go/en/advance/mux/">
<link rel="stylesheet" href="https://azadzadeh.github.io/trojan-go/css/theme.min.css">
<script src="https://use.fontawesome.com/releases/v5.0.6/js/all.js"></script>
<link rel="stylesheet" href="https://azadzadeh.github.io/trojan-go/css/chroma.min.css">
<script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery.easing@1.4.1/jquery.easing.min.js"></script>
<script src="https://azadzadeh.github.io/trojan-go/js/bundle.js"></script><style>
:root {}
</style>
<meta property="og:title" content="Enabling multiplexing to improve network concurrency performance" />
<meta property="og:description" content="Compatibility Note that Trojan does not support this feature
Trojan-Go supports the use of multiplexing to improve network concurrency performance.
The Trojan protocol is based on TLS, and before a secure TLS connection can be established, both sides of the connection need to negotiate and exchange keys to ensure the security of the subsequent communication. This process is known as the TLS handshake.
The GFW currently censors and interferes with the TLS handshake, and due to egress network congestion, it usually takes nearly a second or more for an ordinary line to complete the TLS handshake." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://azadzadeh.github.io/trojan-go/en/advance/mux/" /><meta property="og:image" content="https://azadzadeh.github.io/trojan-go/images/og-image.png"/><meta property="article:section" content="advance" />

<meta property="og:site_name" content="Trojan-Go Docs" />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://azadzadeh.github.io/trojan-go/images/og-image.png"/>

<meta name="twitter:title" content="Enabling multiplexing to improve network concurrency performance"/>
<meta name="twitter:description" content="Compatibility Note that Trojan does not support this feature
Trojan-Go supports the use of multiplexing to improve network concurrency performance.
The Trojan protocol is based on TLS, and before a secure TLS connection can be established, both sides of the connection need to negotiate and exchange keys to ensure the security of the subsequent communication. This process is known as the TLS handshake.
The GFW currently censors and interferes with the TLS handshake, and due to egress network congestion, it usually takes nearly a second or more for an ordinary line to complete the TLS handshake."/>
<meta itemprop="name" content="Enabling multiplexing to improve network concurrency performance">
<meta itemprop="description" content="Compatibility Note that Trojan does not support this feature
Trojan-Go supports the use of multiplexing to improve network concurrency performance.
The Trojan protocol is based on TLS, and before a secure TLS connection can be established, both sides of the connection need to negotiate and exchange keys to ensure the security of the subsequent communication. This process is known as the TLS handshake.
The GFW currently censors and interferes with the TLS handshake, and due to egress network congestion, it usually takes nearly a second or more for an ordinary line to complete the TLS handshake.">

<meta itemprop="wordCount" content="427"><meta itemprop="image" content="https://azadzadeh.github.io/trojan-go/images/og-image.png"/>
<meta itemprop="keywords" content="" /></head>
<body><div class="container"><header>
<h1>Trojan-Go Docs</h1>
<a href="https://github.com/p4gefau1t/trojan-go" class="github"><i class="fab fa-github"></i></a>
<p class="description">An unidentifiable mechanism that helps you bypass GFW.</p>

</header>
<div class="global-menu">
<nav>
<ul>
<li><a href="/trojan-go/en/">English (DeepL)</a></li>
<li><a href="/trojan-go/zh/">Chinese (original)</a></li>
<li><a href="https://github.com/p4gefau1t">GitHub</a></li></ul>
</nav>
</div>
<div class="content-container">
<main><h1>Enabling multiplexing to improve network concurrency performance</h1>
<div class="panel panel-caution"><div class="panel-header">
<h3>Compatibility</h3>
</div><div class="panel-body">
<p>Note that Trojan does not support this feature</p>
</div>
</div>
<p>Trojan-Go supports the use of multiplexing to improve network concurrency performance.</p>
<p>The Trojan protocol is based on TLS, and before a secure TLS connection can be established, both sides of the connection need to negotiate and exchange keys to ensure the security of the subsequent communication. This process is known as the TLS handshake.</p>
<p>The GFW currently censors and interferes with the TLS handshake, and due to egress network congestion, it usually takes nearly a second or more for an ordinary line to complete the TLS handshake. This can lead to increased latency for web browsing and video viewing.</p>
<p>Trojan-Go uses multiplexing to solve this problem. Each established TLS connection will host multiple TCP connections. When a new proxy request arrives, instead of handshaking with the server to initiate a new TLS connection, existing TLS connections are reused whenever possible. This reduces the latency caused by frequent TLS handshakes and TCP handshakes.</p>
<p>Enabling multiplexing will not increase your link speed (or even decrease it), and may increase the computational burden on the server and client. Roughly speaking, multiplexing can be interpreted as sacrificing network throughput and CPU power for lower latency. It can improve the usage experience in high concurrency scenarios, such as when browsing web pages containing a large number of images, or when sending a large number of UDP requests.</p>
<p>To activate the <code>mux</code> module, just set the <code>enabled</code> field in the <code>mux</code> option to true, here is a client-side example</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">...</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;mux&#34;</span> <span style="color:#960050;background-color:#1e0010">:</span>{
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;enabled&#34;</span>: <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Just configure the client side, the server side can be adapted automatically without configuring the <code>mux</code> option.</p>
<p>The complete mux configuration is as follows</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#e6db74">&#34;mux&#34;</span><span style="color:#960050;background-color:#1e0010">:</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;enabled&#34;</span>: <span style="color:#66d9ef">false</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;concurrency&#34;</span>: <span style="color:#ae81ff">8</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;idle_timeout&#34;</span>: <span style="color:#ae81ff">60</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><code>concurrency</code> is the maximum number of TCP connections that each TLS connection can carry. The larger this value is, the more each TLS connection is reused and the lower the latency due to handshaking. However, the greater the computational burden on the server and client will also be, which could potentially make your network throughput lower. If your line&rsquo;s TLS handshake is extremely slow, you can set this value to -1 and Trojan-Go will perform only one TLS handshake, using only one TLS connection for transmission.</p>
<p>The <code>idle_timeout</code> refers to how long each TLS connection is idle before it is closed. Setting the timeout time <strong>may</strong> help reduce unnecessary long connection live confirmation (Keep Alive) traffic transmissions triggering GFW probes. You can set this value to -1 and TLS connections will be closed immediately when idle.</p>
<div class="edit-meta">

<br><a href="https://github.com/p4gefau1t/trojan-go/docs/edit/master/content/advance/mux.md" class="edit-page"><i class="fas fa-pen-square"></i> Edit on GitHub</a></div><nav class="pagination"><a class="nav nav-prev" href="https://azadzadeh.github.io/trojan-go/en/advance/" title="Advanced Configuration"><i class="fas fa-arrow-left" aria-hidden="true"></i> Prev - Advanced Configuration</a>
<a class="nav nav-next" href="https://azadzadeh.github.io/trojan-go/en/advance/websocket/" title="CDN forwarding and resisting man-in-the-middle attacks using Websocket">Next - CDN forwarding and resisting man-in-the-middle attacks using Websocket <i class="fas fa-arrow-right" aria-hidden="true"></i></a>
</nav><footer><p class="powered">Powered by <a href="https://gohugo.io">Hugo</a>. Theme by <a href="https://themes.gohugo.io/hugo-theme-techdoc/">TechDoc</a>. Designed by <a href="https://github.com/thingsym/hugo-theme-techdoc">Thingsym</a>.</p>
</footer>
</main><div class="sidebar">

<nav class="open-menu">
<ul>
<li class=""><a href="https://azadzadeh.github.io/trojan-go">Home</a></li>

<li class=""><a href="https://azadzadeh.github.io/trojan-go/en/basic/">Basic Configuration</a>
  
<ul class="sub-menu">
<li class=""><a href="https://azadzadeh.github.io/trojan-go/en/basic/trojan/">Trojan fundamentals</a></li>
<li class=""><a href="https://azadzadeh.github.io/trojan-go/en/basic/config/">Configuring Trojan-Go correctly</a></li>
<li class=""><a href="https://azadzadeh.github.io/trojan-go/en/basic/full-config/">Full configuration file</a></li>
</ul>
  
</li>

<li class="parent"><a href="https://azadzadeh.github.io/trojan-go/en/advance/">Advanced Configuration</a>
  
<ul class="sub-menu">
<li class="active"><a href="https://azadzadeh.github.io/trojan-go/en/advance/mux/">Enabling multiplexing to improve network concurrency performance</a></li>
<li class=""><a href="https://azadzadeh.github.io/trojan-go/en/advance/websocket/">CDN forwarding and resisting man-in-the-middle attacks using Websocket</a></li>
<li class=""><a href="https://azadzadeh.github.io/trojan-go/en/advance/router/">Domestic direct connection and ad blocking</a></li>
<li class=""><a href="https://azadzadeh.github.io/trojan-go/en/advance/forward/">Tunnels and reverse proxies</a></li>
<li class=""><a href="https://azadzadeh.github.io/trojan-go/en/advance/nginx-relay/">A multi-path split relaying scheme based on SNI proxy</a></li>
<li class=""><a href="https://azadzadeh.github.io/trojan-go/en/advance/plugin/">Using Shadowsocks Plugin/Pluggable Transport Layer</a></li>
<li class=""><a href="https://azadzadeh.github.io/trojan-go/en/advance/customize-protocol-stack/">Custom Protocol Stack</a></li>
<li class=""><a href="https://azadzadeh.github.io/trojan-go/en/advance/aead/">Secondary encryption with Shadowsocks AEAD</a></li>
<li class=""><a href="https://azadzadeh.github.io/trojan-go/en/advance/api/">Managing users dynamically using the API</a></li>
<li class=""><a href="https://azadzadeh.github.io/trojan-go/en/advance/nat/">Transparent Proxy</a></li>
</ul>
  
</li>

<li class=""><a href="https://azadzadeh.github.io/trojan-go/en/developer/">Implementation details and development guidelines</a>
  
<ul class="sub-menu">
<li class=""><a href="https://azadzadeh.github.io/trojan-go/en/developer/overview/">Basic introduction</a></li>
<li class=""><a href="https://azadzadeh.github.io/trojan-go/en/developer/build/">Compiling and customizing Trojan-Go</a></li>
<li class=""><a href="https://azadzadeh.github.io/trojan-go/en/developer/trojan/">Trojan Protocol</a></li>
<li class=""><a href="https://azadzadeh.github.io/trojan-go/en/developer/mux/">Multiplexing</a></li>
<li class=""><a href="https://azadzadeh.github.io/trojan-go/en/developer/websocket/">Websocket</a></li>
<li class=""><a href="https://azadzadeh.github.io/trojan-go/en/developer/simplesocks/">SimpleSocks Protocol</a></li>
<li class=""><a href="https://azadzadeh.github.io/trojan-go/en/developer/api/">API Development</a></li>
<li class=""><a href="https://azadzadeh.github.io/trojan-go/en/developer/plugin/">Pluggable transport layer plug-in development</a></li>
<li class=""><a href="https://azadzadeh.github.io/trojan-go/en/developer/url/">URL scheme (draft)</a></li>
</ul>
  
</li>
</ul>
</nav>



<div class="sidebar-footer"></div>
</div>
</div><a href="#" id="backtothetop-fixed" class="backtothetop"
 data-backtothetop-duration="600"
 data-backtothetop-easing="easeOutQuart"
 data-backtothetop-fixed-fadeIn="1000"
 data-backtothetop-fixed-fadeOut="1000"
 data-backtothetop-fixed-bottom="10"
 data-backtothetop-fixed-right="20">
<span class="fa-layers fa-fw">
<i class="fas fa-circle"></i>
<i class="fas fa-arrow-circle-up"></i>
</span></a>
</div>
</body>
</html>
