<!DOCTYPE html>
<html lang="en-US">
<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<title>Managing users dynamically using the API - Trojan-Go Docs</title>
<meta name="description" content="An unidentifiable mechanism that helps you bypass GFW.">
<meta name="generator" content="Hugo 0.108.0">
<link href="https://azadzadeh.github.io/trojan-goindex.xml" rel="alternate" type="application/rss+xml">
<link rel="canonical" href="https://azadzadeh.github.io/trojan-go/en/advance/api/">
<link rel="stylesheet" href="https://azadzadeh.github.io/trojan-go/css/theme.min.css">
<script src="https://use.fontawesome.com/releases/v5.0.6/js/all.js"></script>
<link rel="stylesheet" href="https://azadzadeh.github.io/trojan-go/css/chroma.min.css">
<script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery.easing@1.4.1/jquery.easing.min.js"></script>
<script src="https://azadzadeh.github.io/trojan-go/js/bundle.js"></script><style>
:root {}
</style>
<meta property="og:title" content="Managing users dynamically using the API" />
<meta property="og:description" content="Compatibility Note that Trojan does not support this feature
Trojan-Go provides a set of APIs using gRPC, which supports the following features.
user information addition, deletion, and checking
traffic statistics
speed statistics
IP connection statistics
Trojan-Go itself has integrated API control, i.e. you can use one Trojan-Go instance to control another Trojan-Go server.
You need to add API settings to the configuration of the server you need to be controlled, e." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://azadzadeh.github.io/trojan-go/en/advance/api/" /><meta property="og:image" content="https://azadzadeh.github.io/trojan-go/images/og-image.png"/><meta property="article:section" content="advance" />

<meta property="og:site_name" content="Trojan-Go Docs" />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://azadzadeh.github.io/trojan-go/images/og-image.png"/>

<meta name="twitter:title" content="Managing users dynamically using the API"/>
<meta name="twitter:description" content="Compatibility Note that Trojan does not support this feature
Trojan-Go provides a set of APIs using gRPC, which supports the following features.
user information addition, deletion, and checking
traffic statistics
speed statistics
IP connection statistics
Trojan-Go itself has integrated API control, i.e. you can use one Trojan-Go instance to control another Trojan-Go server.
You need to add API settings to the configuration of the server you need to be controlled, e."/>
<meta itemprop="name" content="Managing users dynamically using the API">
<meta itemprop="description" content="Compatibility Note that Trojan does not support this feature
Trojan-Go provides a set of APIs using gRPC, which supports the following features.
user information addition, deletion, and checking
traffic statistics
speed statistics
IP connection statistics
Trojan-Go itself has integrated API control, i.e. you can use one Trojan-Go instance to control another Trojan-Go server.
You need to add API settings to the configuration of the server you need to be controlled, e.">

<meta itemprop="wordCount" content="409"><meta itemprop="image" content="https://azadzadeh.github.io/trojan-go/images/og-image.png"/>
<meta itemprop="keywords" content="" /></head>
<body><div class="container"><header>
<h1>Trojan-Go Docs</h1>
<a href="https://github.com/p4gefau1t/trojan-go" class="github"><i class="fab fa-github"></i></a>
<p class="description">An unidentifiable mechanism that helps you bypass GFW.</p>

</header>
<div class="global-menu">
<nav>
<ul>
<li><a href="/trojan-go/en/">English (DeepL)</a></li>
<li><a href="/trojan-go/zh/">Chinese (original)</a></li>
<li><a href="https://github.com/p4gefau1t">GitHub</a></li></ul>
</nav>
</div>
<div class="content-container">
<main><h1>Managing users dynamically using the API</h1>
<div class="panel panel-caution"><div class="panel-header">
<h3>Compatibility</h3>
</div><div class="panel-body">
<p>Note that Trojan does not support this feature</p>
</div>
</div>
<p>Trojan-Go provides a set of APIs using gRPC, which supports the following features.</p>
<ul>
<li>
<p>user information addition, deletion, and checking</p>
</li>
<li>
<p>traffic statistics</p>
</li>
<li>
<p>speed statistics</p>
</li>
<li>
<p>IP connection statistics</p>
</li>
</ul>
<p>Trojan-Go itself has integrated API control, i.e. you can use one Trojan-Go instance to control another Trojan-Go server.</p>
<p>You need to add API settings to the configuration of the server you need to be controlled, e.g.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#960050;background-color:#1e0010">...</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;api&#34;</span>: {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;enabled&#34;</span>: <span style="color:#66d9ef">true</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;api_addr&#34;</span>: <span style="color:#e6db74">&#34;127.0.0.1&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;api_port&#34;</span>: <span style="color:#ae81ff">10000</span>,
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Then start the Trojan-Go server</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>. /trojan-go -config . /server.json
</span></span></code></pre></div><p>You can then use another Trojan-Go to connect to that server for administration, with the basic command format</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>. /trojan-go -api-addr SERVER_API_ADDRESS -api COMMAND
</span></span></code></pre></div><p>where <code>SERVER_API_ADDRESS</code> is the API address and port, e.g. 127.0.0.1:10000</p>
<p><code>COMMAND</code> is the API command, the legal commands are</p>
<ul>
<li>
<p>list List all users</p>
</li>
<li>
<p>get to get information about a user</p>
</li>
<li>
<p>set set the information of a user (add/remove/modify)</p>
</li>
</ul>
<p>Here are some examples</p>
<ol>
<li>
<p>list all user information</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>. /trojan-go -api-addr 127.0.0.1:10000 -api list
</span></span></code></pre></div><p>All user information will be exported as json, the information includes the number of online IPs, live speed, total upload and download traffic, etc. Here is an example of the returned results</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>[{<span style="color:#f92672">&#34;user&#34;</span>:{<span style="color:#f92672">&#34;hash&#34;</span>:<span style="color:#e6db74">&#34;d63dc919e201d7bc4c825630d2cf25fdc93d4b2f0d46706d29038d01&#34;</span>},<span style="color:#f92672">&#34;status&#34;</span>:{<span style="color:#f92672">&#34;traffic_total&#34;</span>:{<span style="color:#f92672">&#34;upload_traffic&#34;</span>:<span style="color:#ae81ff">36393</span>,<span style="color:#f92672">&#34;download_traffic&#34;</span>:<span style="color:#ae81ff">186478</span>},<span style="color:#f92672">&#34;speed_current&#34;</span>:{<span style="color:#f92672">&#34;upload_speed&#34;</span>:<span style="color:#ae81ff">25210</span>,<span style="color:#f92672">&#34;download_speed&#34;</span>:<span style="color:#ae81ff">72384</span>},<span style="color:#f92672">&#34;speed_limit&#34;</span>:{<span style="color:#f92672">&#34;upload_speed&#34;</span>:<span style="color:#ae81ff">5242880</span>,<span style="color:#f92672">&#34;download_speed&#34;</span>:<span style="color:#ae81ff">5242880</span>},<span style="color:#f92672">&#34;ip_limit&#34;</span>:<span style="color:#ae81ff">50</span>}}]
</span></span></code></pre></div><p>All traffic units are bytes.</p>
</li>
<li>
<p>Get a user&rsquo;s information</p>
<p>You can use -target-password to specify the password, or -target-hash to specify the SHA224 hash of the target user&rsquo;s password. The format is the same as the list command</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>. /trojan-go -api-addr 127.0.0.1:10000 -api get -target-password password
</span></span></code></pre></div><p>or</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>. /trojan-go -api-addr 127.0.0.1:10000 -api get -target-hash d63dc919e201d7bc4c825630d2cf25fdc93d4b2f0d46706d29038d01
</span></span></code></pre></div><p>The above two commands are equivalent. The following example uses the plaintext password in a uniform way, and the hash specifies a certain user in a similar way.</p>
<p>The user information will be exported in the form of json in a format similar to the list command. Here is an example of the returned result</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{<span style="color:#f92672">&#34;user&#34;</span>:{<span style="color:#f92672">&#34;hash&#34;</span>:<span style="color:#e6db74">&#34;d63dc919e201d7bc4c825630d2cf25fdc93d4b2f0d46706d29038d01&#34;</span>},<span style="color:#f92672">&#34;status&#34;</span>:{<span style="color:#f92672">&#34;traffic_total&#34;</span>:{<span style="color:#f92672">&#34;upload_traffic&#34;</span>:<span style="color:#ae81ff">36393</span>,<span style="color:#f92672">&#34;download_traffic&#34;</span>:<span style="color:#ae81ff">186478</span>},<span style="color:#f92672">&#34;speed_current&#34;</span>:{<span style="color:#f92672">&#34;upload_speed&#34;</span>:<span style="color:#ae81ff">25210</span>,<span style="color:#f92672">&#34;download_speed&#34;</span>:<span style="color:#ae81ff">72384</span>},<span style="color:#f92672">&#34;speed_limit&#34;</span>:{<span style="color:#f92672">&#34;upload_speed&#34;</span>:<span style="color:#ae81ff">5242880</span>,<span style="color:#f92672">&#34;download_speed&#34;</span>:<span style="color:#ae81ff">5242880</span>},<span style="color:#f92672">&#34;ip_limit&#34;</span>:<span style="color:#ae81ff">50</span>}}
</span></span></code></pre></div></li>
<li>
<p>add a user information</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>. /trojan-go -api-addr 127.0.0.1:10000 -api set -add-profile -target-password password
</span></span></code></pre></div></li>
<li>
<p>delete a user information</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>. /trojan-go -api-addr 127.0.0.1:10000 -api set -delete-profile -target-password password
</span></span></code></pre></div></li>
<li>
<p>modify a user information</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>. /trojan-go -api-addr 127.0.0.1:10000 -api set -modify-profile -target-password password <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>    -ip-limit <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>    -upload-speed-limit <span style="color:#ae81ff">5242880</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>    -download-speed-limit <span style="color:#ae81ff">5242880</span>
</span></span></code></pre></div><p>This command limits the upload and download speed to 5MiB/s for users with password, and the number of connected IPs is limited to 3. Note that the unit of 5242880 here is bytes. If you fill in 0 or a negative number, it means no limit is applied.</p>
</li>
</ol>
<div class="edit-meta">

<br><a href="https://github.com/p4gefau1t/trojan-go/docs/edit/master/content/advance/api.md" class="edit-page"><i class="fas fa-pen-square"></i> Edit on GitHub</a></div><nav class="pagination"><a class="nav nav-prev" href="https://azadzadeh.github.io/trojan-go/en/advance/aead/" title="Secondary encryption with Shadowsocks AEAD"><i class="fas fa-arrow-left" aria-hidden="true"></i> Prev - Secondary encryption with Shadowsocks AEAD</a>
<a class="nav nav-next" href="https://azadzadeh.github.io/trojan-go/en/advance/nat/" title="Transparent Proxy">Next - Transparent Proxy <i class="fas fa-arrow-right" aria-hidden="true"></i></a>
</nav><footer><p class="powered">Powered by <a href="https://gohugo.io">Hugo</a>. Theme by <a href="https://themes.gohugo.io/hugo-theme-techdoc/">TechDoc</a>. Designed by <a href="https://github.com/thingsym/hugo-theme-techdoc">Thingsym</a>.</p>
</footer>
</main><div class="sidebar">

<nav class="open-menu">
<ul>
<li class=""><a href="https://azadzadeh.github.io/trojan-go">Home</a></li>

<li class=""><a href="https://azadzadeh.github.io/trojan-go/en/basic/">Basic Configuration</a>
  
<ul class="sub-menu">
<li class=""><a href="https://azadzadeh.github.io/trojan-go/en/basic/trojan/">Trojan fundamentals</a></li>
<li class=""><a href="https://azadzadeh.github.io/trojan-go/en/basic/config/">Configuring Trojan-Go correctly</a></li>
<li class=""><a href="https://azadzadeh.github.io/trojan-go/en/basic/full-config/">Full configuration file</a></li>
</ul>
  
</li>

<li class="parent"><a href="https://azadzadeh.github.io/trojan-go/en/advance/">Advanced Configuration</a>
  
<ul class="sub-menu">
<li class=""><a href="https://azadzadeh.github.io/trojan-go/en/advance/mux/">Enabling multiplexing to improve network concurrency performance</a></li>
<li class=""><a href="https://azadzadeh.github.io/trojan-go/en/advance/websocket/">CDN forwarding and resisting man-in-the-middle attacks using Websocket</a></li>
<li class=""><a href="https://azadzadeh.github.io/trojan-go/en/advance/router/">Domestic direct connection and ad blocking</a></li>
<li class=""><a href="https://azadzadeh.github.io/trojan-go/en/advance/forward/">Tunnels and reverse proxies</a></li>
<li class=""><a href="https://azadzadeh.github.io/trojan-go/en/advance/nginx-relay/">A multi-path split relaying scheme based on SNI proxy</a></li>
<li class=""><a href="https://azadzadeh.github.io/trojan-go/en/advance/plugin/">Using Shadowsocks Plugin/Pluggable Transport Layer</a></li>
<li class=""><a href="https://azadzadeh.github.io/trojan-go/en/advance/customize-protocol-stack/">Custom Protocol Stack</a></li>
<li class=""><a href="https://azadzadeh.github.io/trojan-go/en/advance/aead/">Secondary encryption with Shadowsocks AEAD</a></li>
<li class="active"><a href="https://azadzadeh.github.io/trojan-go/en/advance/api/">Managing users dynamically using the API</a></li>
<li class=""><a href="https://azadzadeh.github.io/trojan-go/en/advance/nat/">Transparent Proxy</a></li>
</ul>
  
</li>

<li class=""><a href="https://azadzadeh.github.io/trojan-go/en/developer/">Implementation details and development guidelines</a>
  
<ul class="sub-menu">
<li class=""><a href="https://azadzadeh.github.io/trojan-go/en/developer/overview/">Basic introduction</a></li>
<li class=""><a href="https://azadzadeh.github.io/trojan-go/en/developer/build/">Compiling and customizing Trojan-Go</a></li>
<li class=""><a href="https://azadzadeh.github.io/trojan-go/en/developer/trojan/">Trojan Protocol</a></li>
<li class=""><a href="https://azadzadeh.github.io/trojan-go/en/developer/mux/">Multiplexing</a></li>
<li class=""><a href="https://azadzadeh.github.io/trojan-go/en/developer/websocket/">Websocket</a></li>
<li class=""><a href="https://azadzadeh.github.io/trojan-go/en/developer/simplesocks/">SimpleSocks Protocol</a></li>
<li class=""><a href="https://azadzadeh.github.io/trojan-go/en/developer/api/">API Development</a></li>
<li class=""><a href="https://azadzadeh.github.io/trojan-go/en/developer/plugin/">Pluggable transport layer plug-in development</a></li>
<li class=""><a href="https://azadzadeh.github.io/trojan-go/en/developer/url/">URL scheme (draft)</a></li>
</ul>
  
</li>
</ul>
</nav>



<div class="sidebar-footer"></div>
</div>
</div><a href="#" id="backtothetop-fixed" class="backtothetop"
 data-backtothetop-duration="600"
 data-backtothetop-easing="easeOutQuart"
 data-backtothetop-fixed-fadeIn="1000"
 data-backtothetop-fixed-fadeOut="1000"
 data-backtothetop-fixed-bottom="10"
 data-backtothetop-fixed-right="20">
<span class="fa-layers fa-fw">
<i class="fas fa-circle"></i>
<i class="fas fa-arrow-circle-up"></i>
</span></a>
</div>
</body>
</html>
